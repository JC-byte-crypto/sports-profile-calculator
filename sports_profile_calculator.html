<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë‚˜ë§Œì˜ ìŠ¤í¬ì¸  í”„ë¡œí•„ ê³„ì‚°ê¸°</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    body { font-family: Arial; padding: 20px; }
    h1 { font-size: 28px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background: #f0f0f0; }
</style>
</head>

<body>

<h1>ë‚˜ë§Œì˜ ìŠ¤í¬ì¸  í”„ë¡œí•„ ì ìˆ˜ ê³„ì‚°ê¸°</h1>
<p>ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ì ìˆ˜ì™€ ìš´ë™ ë ˆë²¨ì´ ê³„ì‚°ë©ë‹ˆë‹¤.</p>

<input type="file" id="excelFile" accept=".xlsx, .xls">

<table id="resultTable" style="display:none;">
    <thead>
        <tr>
            <th>ì´ë©”ì¼</th>
            <th>ìš´ë™ ì—¬ë¶€</th>
            <th>ìš´ë™ ì¢…ë¥˜ ìˆ˜</th>
            <th>ì£¼ë‹¹ ìš´ë™ ë¹ˆë„</th>
            <th>ì ìˆ˜</th>
            <th>ìš´ë™ ë ˆë²¨</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
document.getElementById("excelFile").addEventListener("change", function(e){
    let file = e.target.files[0];
    let reader = new FileReader();

    reader.onload = function(event){
        let data = event.target.result;
        let workbook = XLSX.read(data, {type:'binary'});
        let sheet = workbook.Sheets[workbook.SheetNames[0]];
        let json = XLSX.utils.sheet_to_json(sheet);

        let tbody = document.querySelector("#resultTable tbody");
        tbody.innerHTML = "";

        json.forEach(row => {
            let email = row["ì´ë©”ì¼ ì£¼ì†Œ"];
            let isExercise = row["ì²´ìœ¡ì‹œê°„ ì´ì™¸ì— í•˜ëŠ” ìš´ë™ì´ ìˆë‚˜ìš”?"] || "";
            let types = row["ê·¸ëŸ¬ë©´ ì–´ë–¤ ìš´ë™ì„ ì£¼ë¡œ í•˜ë‚˜ìš”?(ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)"] || "";
            let freq = row["ì–¼ë§ˆë‚˜ ìì£¼ í•˜ë‚˜ìš”?(1ì£¼ì¼)"] || "";

            let typeCount = types ? types.split(",").length : 0;
            let freqNum = parseInt(freq) || 0;

            let score = 0;
            if (isExercise === "ë„¤") score += 10;
            score += typeCount * 5;

            if (freqNum >= 0 && freqNum <= 1) score += 5;
            else if (freqNum <= 3) score += 10;
            else if (freqNum <= 5) score += 15;
            else score += 20;

            let level = "";
            if (score <= 20) level = "ğŸ¥‰ ì´ˆê¸‰";
            else if (score <= 40) level = "ğŸ¥ˆ ì¤‘ê¸‰";
            else level = "ğŸ¥‡ ê³ ê¸‰";

            let tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${email}</td>
                <td>${isExercise}</td>
                <td>${typeCount}</td>
                <td>${freqNum}ì¼</td>
                <td>${score}</td>
                <td>${level}</td>
            `;
            tbody.appendChild(tr);
        });

        document.getElementById("resultTable").style.display = "table";
    };

    reader.readAsBinaryString(file);
});
</script>

</body>
</html>
